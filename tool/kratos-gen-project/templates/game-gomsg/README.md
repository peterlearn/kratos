# Demo

## 游戏服务
    游戏服务器，提供更完善的代码生成以及基础库。
    
####基本思路

- 进入游戏流程： 

连接ws -> 校验玩家准入，加载玩家数据，生成player对象（ws协程） -> 入桌，找到桌子号（房间队列协程）-> 
入桌后事件，找到椅子，逻辑事件 (桌子协程)

- 换桌流程：

检测玩家能否换桌（本桌队列协程）-> 换桌，找到新的桌子号（房间队列协程） ，删除老桌椅子号数据（桌子协程），
新增椅子数据（桌子协程）。

        
- 其他逻辑

客户端请求(ws协程) -> 服务端逻辑处理(本桌队列协程) 
        
## 特性

* **自动生成代码** 定义proto，自动生成gomsg接口和http接口，只需要在service包实现接口。

生成命令：  `kratos tool protoc --gomsg api.proto`

* **高并发设计** 默认生成房间队列和每个桌子一个队列。
一般情况，入桌和换桌进入房间队列，其他请求使用本桌队列。

* 规范的代码组织架构
```markdown
internal包实现所有逻辑，禁止外部调用。 
internal/logic 为桌子逻辑总线，已桌子逻辑线索，其他模块支撑。
internal/mgr   桌子管理，玩家管理包
internal/server 启动http服务，websocket服务
internal/service 统一的接口实现
```
    
* 自带业务监控
```markdown
可观察的业务调用关系和性能分析。
协程泄漏和致命报错等可添加报警。
```

